# DDACOIN node: time-based consensus, 1 hour per block.
# P2P port 9666, DNS seeds ddacoinminer01.kos.engineer and ddacoinminer02.kos.engineer.
# Copy .env.example to .env and set RPC_USER, RPC_PASS; for miner mode also set MINING_ADDR.
#
# Miner mode (default): docker compose up -d          â†’ runs with --generate and --miningaddr
# Node-only mode:       docker compose -f docker-compose.yml -f docker-compose.node.yml up -d
#
# Network ddacoin-net allows explorer (in explorer/) to reach node as ddacoin-node:9667.

services:
  ddacoin:
    build: .
    image: ddacoin:latest
    container_name: ddacoin-node
    ports:
      - "9666:9666"   # P2P
      - "9667:9667"   # RPC
    volumes:
      - ddacoin-data:/data
    networks:
      - ddacoin-net
    command:
      - "-b"
      - "/data"
      - "--rpcuser=${RPC_USER}"
      - "--rpcpass=${RPC_PASS}"
      - "--rpclisten=0.0.0.0:9667"
      - "--rpcmaxclients=50"
      - "--txindex"
      - "--addrindex"
      - "${DDACOIN_TESTNET:+--ddacointestnet}"
      - "${HIGHPOWER:+--highpower}"
      - "${NO_IPV6:+--noipv6}"
      - "--generate"
      - "--miningaddr=${MINING_ADDR}"
    restart: unless-stopped

networks:
  ddacoin-net:
    name: ddacoin-net

volumes:
  ddacoin-data: {}